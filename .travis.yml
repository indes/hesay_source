# https://docs.travis-ci.com/user/deployment/pages/
# https://docs.travis-ci.com/user/languages/python/
language: python

python:
    - "3.6"

install:
    # install latest release version
    #- wget $(wget -qO- https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n '/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*"([^"]*)".*@\1@g;p}}')
    - wget -qO- https://api.github.com/repos/gohugoio/hugo/releases/latest | sed -r -n '/browser_download_url/{/Linux-64bit.deb/{s@[^:]*:[[:space:]]*"([^"]*)".*@\1@g;p}}' | xargs wget
    - sudo dpkg -i hugo*.deb
    - pip install Pygments
    - rm -rf public 2> /dev/null

script:

    - git clone "https://wanglics:${CO_TOKEN}@${CO_REF}" public
    - hugo
    - cd ./public
    - git config user.name "indes"
    - git config user.email "wanglicsly@gmail.com"
    - git add .
    - git commit -m "Travis-CI 自动部署"
    # Coding Pages
    - git push "https://wanglics:${CO_TOKEN}@${CO_REF}" master:master

deploy:
    
env:
    global:
        # Coding Pages
        - CO_REF: git.coding.net/wanglics/hesay_hugo_public_new.git    